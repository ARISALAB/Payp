<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Συναλλαγές ανά Προμηθευτή</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            font-family: Arial, sans-serif;
        }

        .tabs-container {
            display: flex;
            flex-direction: column;
            margin-top: 20px;
        }

        .tab-button {
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            padding: 10px;
            cursor: pointer;
            margin-bottom: 5px;
            border-radius: 5px;
        }

        .tab-button.active {
            background-color: #343a40;
            color: #fff;
        }

        .transactions-container {
            display: none;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f8f9fa;
        }

        .transactions-container.active {
            display: block;
        }

        .transaction {
            margin-bottom: 15px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #ffffff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>
    <h1>Συναλλαγές ανά Προμηθευτή</h1>
    <div class="tabs-container" id="tabs-container"></div>
    <div id="transactions-section"></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
        import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js";

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAlFCOK49HAzisru-KTTF0ZqP_mtmEyt6Y",
            authDomain: "speedy-bazaar-411110.firebaseapp.com",
            databaseURL: "https://speedy-bazaar-411110-default-rtdb.firebaseio.com",
            projectId: "speedy-bazaar-411110",
            storageBucket: "speedy-bazaar-411110.appspot.com",
            messagingSenderId: "752456596300",
            appId: "1:752456596300:web:f920df7be01ba63d66ede9",
            measurementId: "G-NGZHWDY6S5"
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        const tabsContainer = document.getElementById('tabs-container');
        const transactionsSection = document.getElementById('transactions-section');

        // Fetch transactions grouped by supplier
        function loadTransactions() {
            const transactionsRef = ref(database, 'transactions');
            onValue(transactionsRef, (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    renderTabs(data);
                }
            });
        }

        // Render tabs and transactions
        function renderTabs(data) {
            tabsContainer.innerHTML = '';
            transactionsSection.innerHTML = '';

            const suppliers = Object.keys(data);

            suppliers.forEach((supplier, index) => {
                // Create tab button
                const tabButton = document.createElement('button');
                tabButton.textContent = supplier;
                tabButton.classList.add('tab-button');
                if (index === 0) tabButton.classList.add('active');
                tabButton.addEventListener('click', () => {
                    activateTab(supplier);
                });
                tabsContainer.appendChild(tabButton);

                // Create transactions container
                const transactionsContainer = document.createElement('div');
                transactionsContainer.id = `transactions-${supplier}`;
                transactionsContainer.classList.add('transactions-container');
                if (index === 0) transactionsContainer.classList.add('active');

                const supplierTransactions = data[supplier];
                for (const key in supplierTransactions) {
                    const transaction = supplierTransactions[key];
                    const transactionDiv = document.createElement('div');
                    transactionDiv.classList.add('transaction');
                    transactionDiv.innerHTML = `
                        <p><strong>Ημερομηνία:</strong> ${transaction.date || 'N/A'}</p>
                        <p><strong>Τιμολόγιο:</strong> ${transaction.invoiceNumber}</p>
                        <p><strong>Περιγραφή:</strong> ${transaction.description}</p>
                        <p><strong>Ποσό:</strong> ${transaction.amount} €</p>
                    `;
                    transactionsContainer.appendChild(transactionDiv);
                }

                transactionsSection.appendChild(transactionsContainer);
            });
        }

        // Activate tab
        function activateTab(supplier) {
            const allTabs = document.querySelectorAll('.tab-button');
            const allContainers = document.querySelectorAll('.transactions-container');

            allTabs.forEach(tab => tab.classList.remove('active'));
            allContainers.forEach(container => container.classList.remove('active'));

            document.querySelector(`.tab-button:contains(${supplier})`).classList.add('active');
            document.getElementById(`transactions-${supplier}`).classList.add('active');
        }

        // Load transactions on page load
        loadTransactions();
    </script>
</body>
</html>
