<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Αρχική Σελίδα - Πλάνα Πληρωμής</title>
    <script src="https://www.paypal.com/sdk/js?client-id=AbP8aGEBpUSbe7x2frrXYzb502UdR7uL3CjpNb-Sp6lk7hy0j9sYRAJORgfzT01owV39NlnKlycB1mcj&currency=EUR"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
    <style>
        /* Στυλ για τα κουτιά των πλάνων και τη διάταξη */
        /* Προσθέστε το CSS από το προηγούμενο παράδειγμα εδώ */
    </style>
</head>
<body>
    <header>
        <h1>Επιλέξτε το Πλάνο Πληρωμής σας</h1>
    </header>

    <section class="pricing-plans">
        <!-- Πλάνα και PayPal Buttons όπως προηγουμένως -->
    </section>

    <footer>
        <p>&copy; 2024 Όλα τα Δικαιώματα Διατηρούνται.</p>
    </footer>

    <div id="user-actions">
        <button id="google-login">Σύνδεση με Google</button>
        <button id="email-login">Σύνδεση με Email</button>
        <button id="logout" style="display: none;">Αποσύνδεση</button>
    </div>

    <script>
        // Firebase Configuration και Αρχικοποίηση
        const firebaseConfig = {
            apiKey: "AIzaSyAlFCOK49HAzisru-KTTF0ZqP_mtmEyt6Y",
            authDomain: "speedy-bazaar-411110.firebaseapp.com",
            projectId: "speedy-bazaar-411110",
            storageBucket: "speedy-bazaar-411110.appspot.com",
            messagingSenderId: "752456596300",
            appId: "1:752456596300:web:f920df7be01ba63d66ede9",
            measurementId: "G-NGZHWDY6S5"
        };
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // Ενεργοποίηση κουμπιού σύνδεσης με Google
        document.getElementById('google-login').addEventListener('click', () => {
            const provider = new firebase.auth.GoogleAuthProvider();
            auth.signInWithPopup(provider).then((result) => {
                // Εδώ μπορείς να αποθηκεύσεις πληροφορίες χρήστη στο Firestore αν χρειάζεται
                const user = result.user;
                console.log('Σύνδεση με Google: ', user.displayName);
                document.getElementById('google-login').style.display = 'none';
                document.getElementById('logout').style.display = 'inline-block';
            }).catch((error) => {
                console.error(error);
            });
        });

        // Σύνδεση με email και κωδικό
        document.getElementById('email-login').addEventListener('click', () => {
            const email = prompt("Εισάγετε το email σας:");
            const password = prompt("Εισάγετε τον κωδικό σας:");
            auth.signInWithEmailAndPassword(email, password).then((userCredential) => {
                const user = userCredential.user;
                console.log('Σύνδεση με email: ', user.email);
                document.getElementById('email-login').style.display = 'none';
                document.getElementById('logout').style.display = 'inline-block';
            }).catch((error) => {
                console.error(error);
            });
        });

        // Αποσύνδεση
        document.getElementById('logout').addEventListener('click', () => {
            auth.signOut().then(() => {
                console.log('Αποσύνδεση επιτυχής');
                document.getElementById('google-login').style.display = 'inline-block';
                document.getElementById('email-login').style.display = 'inline-block';
                document.getElementById('logout').style.display = 'none';
            }).catch((error) => {
                console.error(error);
            });
        });

        // Αποθήκευση πληρωμής στο Firestore μετά την επιτυχή πληρωμή
        function savePaymentToFirestore(userId, plan, amount) {
            db.collection('payments').add({
                userId: userId,
                plan: plan,
                amount: amount,
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            }).then((docRef) => {
                console.log("Η πληρωμή αποθηκεύτηκε με ID: ", docRef.id);
            }).catch((error) => {
                console.error("Σφάλμα αποθήκευσης πληρωμής: ", error);
            });
        }

        // Παράδειγμα PayPal Button για το Βασικό Πλάνο (€10)
        paypal.Buttons({
            createOrder: function(data, actions) {
                return actions.order.create({
                    purchase_units: [{
                        amount: {
                            value: '10.00'
                        }
                    }]
                });
            },
            onApprove: function(data, actions) {
                return actions.order.capture().then(function(details) {
                    const user = auth.currentUser;
                    if (user) {
                        savePaymentToFirestore(user.uid, 'Βασικό', 10);
                        alert('Σας ευχαριστούμε για την αγορά σας, ' + details.payer.name.given_name + '!');
                        // Ενεργοποίηση κουμπιού κατεύθυνσης στην εφαρμογή
                        alert("Κάντε κλικ για να μεταβείτε στην εφαρμογή!");
                    }
                });
            }
        }).render('#paypal-button-basic');

        // Εδώ μπορείς να προσθέσεις άλλες λειτουργίες PayPal για τα υπόλοιπα πλάνα.
    </script>
</body>
</html>
