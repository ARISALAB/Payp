<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css"> <!-- Σύνδεσμος στο αρχείο CSS -->
    <link rel="icon" href="11.png" type="image/png">
    <title>Καταγραφή Εσόδων</title>
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.13.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.13.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.13.0/firebase-analytics.js"></script>

   <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.13.0/firebase-app.js";
  import { getFirestore } from "https://www.gstatic.com/firebasejs/9.13.0/firebase-firestore.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.13.0/firebase-analytics.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAlFCOK49HAzisru-KTTF0ZqP_mtmEyt6Y",
    authDomain: "speedy-bazaar-411110.firebaseapp.com",
    projectId: "speedy-bazaar-411110",
    storageBucket: "speedy-bazaar-411110.appspot.com",
    messagingSenderId: "752456596300",
    appId: "1:752456596300:web:f920df7be01ba63d66ede9",
    measurementId: "G-NGZHWDY6S5"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const analytics = getAnalytics(app);

  // Function to save revenue to Firestore
  function saveRevenue(date, cashRevenue, cardRevenue) {
    db.collection('revenues').doc(date).set({
      cash: cashRevenue,
      card: cardRevenue
    }).then(() => {
      console.log("Τα έσοδα καταχωρήθηκαν επιτυχώς");
    }).catch((error) => {
      console.error("Σφάλμα κατά την καταχώρηση των εσόδων: ", error);
    });
  }

  // Function to update the summary after submission
  function updateSummary(date) {
    db.collection('revenues').doc(date).get().then((doc) => {
      if (doc.exists) {
        const data = doc.data();
        const cashRevenue = data.cash || 0;
        const cardRevenue = data.card || 0;
        const totalPayments = 0; // Προσθήκη λειτουργικότητας για πληρωμές εάν είναι απαραίτητο
        const balance = cashRevenue - cardRevenue - totalPayments;

        document.getElementById('revenue-date-display').textContent = `Ημερομηνία: ${date}`;
        document.getElementById('cash-revenue-display').textContent = `Ταμείο Ημέρας: ${cashRevenue.toFixed(2)} €`;
        document.getElementById('card-revenue-display').textContent = `Έσοδα από Κάρτες: ${cardRevenue.toFixed(2)} €`;
        document.getElementById('total-payments-display').textContent = `Συνολικές Πληρωμές με Μετρητά: ${totalPayments.toFixed(2)} €`;
        document.getElementById('balance-display').textContent = `Υπόλοιπο Μετρητών: ${balance.toFixed(2)} €`;
      } else {
        console.log("Δεν βρέθηκαν δεδομένα για την ημερομηνία:", date);
      }
    }).catch((error) => {
      console.error("Σφάλμα κατά την ανάκτηση των δεδομένων: ", error);
    });
  }

  document.addEventListener('DOMContentLoaded', () => {
    const revenueForm = document.getElementById('revenue-form');
    revenueForm.addEventListener('submit', (event) => {
      event.preventDefault();
      const date = document.getElementById('revenue-date').value;
      const cashRevenue = parseFloat(document.getElementById('cash-revenue').value) || 0;
      const cardRevenue = parseFloat(document.getElementById('card-revenue').value) || 0;

      saveRevenue(date, cashRevenue, cardRevenue);
      updateSummary(date);
    });
  });
</script>

</head>
<body>
  <nav>
        <img src="11.png" alt="Logo" class="logo">
        <button class="menu-toggle">
            &#9776;<br>Menu
        </button>
        <div class="menu-items">
            <a href="index.html">Αρχική Σελίδα</a>
    
            <div class="dropdown">
                <a href="#">Συναλλαγές &#9662;</a>
                <div class="dropdown-content">
                    <a href="index1.html">Καταγραφή Εξόδων</a>
                    <a href="index4.html">Τιμολόγια Επί Πιστώσει</a>
                    <a href="index5.html">Πληρωμές Τράπεζας</a>
                </div>
            </div>
    
            <a href="index3.html">Καταγραφή Εσόδων</a>
            <a href="index2.html">Καρτέλες Προμηθευτών</a>
    
            <div class="dropdown">
                <a href="#">Αναφορές &#9662;</a>
                <div class="dropdown-content">
                    <a href="index7.html">Ημερήσια Αναφορά</a>
                    <a href="index6.html">Εβδομαδιαία Αναφορά</a>
                    <a href="index8.html">Μηνιαία Αναφορά</a>
                    <a href="index9.html">Ετήσια Αναφορά</a>
                </div>
            </div>
    
            <div class="dropdown">
                <a href="#">Προσωπικό &#9662;</a>
                <div class="dropdown-content">
                    <a href="employee-management.html">Καταγραφή Προσωπικού</a>
                    <a href="salary.html">Καταγραφή Μισθοδοσίας</a>
                    <a href="weekly-salary.html">Εβδομαδιαία Μισθοδοσία </a>
                    <a href="salary-report.html">Αναφορά Μισθοδοσίας</a>
                    

                </div>
            </div>
        </div>
    </nav>
    

    <div id="menuModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <a href="index.html">Αρχική Σελίδα</a>
            
            <div class="dropdown">
                <a href="#">Συναλλαγές</a>
                <div class="dropdown-content">
                    <a href="index1.html">Καταγραφή Εξόδων</a>
                    <a href="index4.html">Τιμολόγια Επί Πιστώσει</a>
                    <a href="index5.html">Πληρωμές Τράπεζας</a>
                </div>
            </div>
            
            <a href="index3.html">Καταγραφή Εσόδων</a>
            <a href="index2.html">Καρτέλες Προμηθευτών</a>
            
            <div class="dropdown">
                <a href="#">Αναφορές</a>
                <div class="dropdown-content">
                    <a href="index7.html">Ημερήσια Αναφορά</a>
                    <a href="index6.html">Εβδομαδιαία Αναφορά</a>
                    <a href="index8.html">Μηνιαία Αναφορά</a>
                    <a href="index9.html">Ετήσια Αναφορά</a>
                </div>
            </div>
            
            <!-- Νέα ενότητα για Προσωπικό -->
            <div class="dropdown">
                <a href="#">Προσωπικό &#9662;</a>
                <div class="dropdown-content">
                    <a href="employee-management.html">Καταγραφή Προσωπικού</a>
                    <a href="salary.html">Καταγραφή Μισθοδοσίας</a>
                    <a href="weekly-salary.html">Εβδομαδιαία Μισθοδοσία</a>
                    <a href="salary-report.html">Αναφορά Μισθοδοσίας</a>
                </div>
            </div>
            
        </div>
    </div>

    <h1>Καταγραφή Εσόδων</h1>
    <form id="revenue-form">
        <label for="revenue-date">Ημερομηνία</label>
        <input type="date" id="revenue-date" required>

        <label for="cash-revenue">Ταμείο Ημέρας (€)</label>
        <input type="number" id="cash-revenue" step="0.01" required>

        <label for="card-revenue">Έσοδα από Κάρτες (€)</label>
        <input type="number" id="card-revenue" step="0.01" required>

        <input type="submit" value="Καταγραφή Εσόδων">
    </form>

    <div id="revenue-summary">
        <p id="revenue-date-display" class="summary-item">Ημερομηνία: -</p>
        <p id="cash-revenue-display" class="summary-item">Ταμείο Ημέρας: 0.00 €</p>
        <p id="card-revenue-display" class="summary-item">Έσοδα από Κάρτες: 0.00 €</p>
        <p id="total-payments-display" class="summary-item">Συνολικές Πληρωμές με Μετρητά: 0.00 €</p>
        <p id="balance-display" class="summary-item">Υπόλοιπο Μετρητών: 0.00 €</p>
    </div>

    <footer>&copy; 2024 Καταγραφή Εσόδων</footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const revenueForm = document.getElementById('revenue-form');
            const revenueDate = document.getElementById('revenue-date');
            const cashRevenueInput = document.getElementById('cash-revenue');
            const cardRevenueInput = document.getElementById('card-revenue');
            const cashRevenueDisplay = document.getElementById('cash-revenue-display');
            const cardRevenueDisplay = document.getElementById('card-revenue-display');
            const totalPaymentsDisplay = document.getElementById('total-payments-display');
            const balanceDisplay = document.getElementById('balance-display');
            const revenueDateDisplay = document.getElementById('revenue-date-display');

            // Function to save revenue to Firestore
            function saveRevenue(date, cashRevenue, cardRevenue) {
                db.collection('revenues').doc(date).set({
                    cash: cashRevenue,
                    card: cardRevenue
                }).then(() => {
                    console.log("Τα έσοδα καταχωρήθηκαν επιτυχώς");
                }).catch((error) => {
                    console.error("Σφάλμα κατά την καταχώρηση των εσόδων: ", error);
                });
            }

            // Function to update the summary after submission
            function updateSummary(date) {
                db.collection('revenues').doc(date).get().then((doc) => {
                    if (doc.exists) {
                        const data = doc.data();
                        const cashRevenue = data.cash || 0;
                        const cardRevenue = data.card || 0;
                        const totalPayments = 0; // Προσθήκη λειτουργικότητας για πληρωμές εάν είναι απαραίτητο
                        const balance = cashRevenue - cardRevenue - totalPayments;

                        revenueDateDisplay.textContent = `Ημερομηνία: ${date}`;
                        cashRevenueDisplay.textContent = `Ταμείο Ημέρας: ${cashRevenue.toFixed(2)} €`;
                        cardRevenueDisplay.textContent = `Έσοδα από Κάρτες: ${cardRevenue.toFixed(2)} €`;
                        totalPaymentsDisplay.textContent = `Συνολικές Πληρωμές με Μετρητά: ${totalPayments.toFixed(2)} €`;
                        balanceDisplay.textContent = `Υπόλοιπο Μετρητών: ${balance.toFixed(2)} €`;
                    }
                }).catch((error) => {
                    console.error("Σφάλμα κατά την ανάκτηση των δεδομένων: ", error);
                });
            }

            // Handle form submission
            revenueForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const date = revenueDate.value;
                if (date) {
                    const cashRevenue = parseFloat(cashRevenueInput.value) || 0;
                    const cardRevenue = parseFloat(cardRevenueInput.value) || 0;
                    saveRevenue(date, cashRevenue, cardRevenue);
                    updateSummary(date);
                    revenueForm.reset();
                }
            });

            // Update the summary when date changes
            revenueDate.addEventListener('change', (e) => {
                const date = e.target.value;
                if (date) {
                    updateSummary(date);
                }
            });
        });
    </script>
</body>
</html>
